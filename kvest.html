<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ò–≥—Ä–∞: –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∞–¥—Ä–µ—Å (7 –∫–ª–∞—Å—Å)</title>
  <style>
    :root {
      --bg1: #0b1020;
      --bg2: #111a33;
      --card: rgba(255,255,255,0.06);
      --border: rgba(255,255,255,0.12);
      --text: #e9ecf1;
      --muted: rgba(233,236,241,0.75);
      --accent: rgba(80,180,255,0.35);
      --ok: rgba(60, 230, 170, 0.18);
      --bad: rgba(255, 90, 120, 0.18);
      --shadow: 0 14px 40px rgba(0,0,0,0.35);
      --radius: 18px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(80,180,255,0.18), transparent 60%),
        radial-gradient(1000px 600px at 90% 30%, rgba(255,90,120,0.12), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height: 100vh;
    }

    .wrap { max-width: 980px; margin: 0 auto; padding: 20px; }
    header {
      display: flex; gap: 12px; flex-wrap: wrap; align-items: center; justify-content: space-between;
      margin-bottom: 14px;
    }

    .titlebox {
      display: grid; gap: 4px;
    }
    .titlebox h1 { margin: 0; font-size: clamp(22px, 3.6vw, 34px); letter-spacing: 0.2px; }
    .titlebox p { margin: 0; color: var(--muted); }

    .chip {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,0.06);
      border: 1px solid var(--border);
      color: var(--muted);
      font-size: 14px;
      user-select: none;
    }

    .progress {
      height: 10px; border-radius: 999px;
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.12);
      overflow: hidden;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
      margin-bottom: 16px;
    }
    .bar {
      height: 100%;
      width: 0%;
      background: rgba(80,180,255,0.55);
      transition: width 260ms ease;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }
    @media (min-width: 900px) {
      .grid { grid-template-columns: 320px 1fr; }
    }

    .panel, .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    .panel { padding: 14px; }
    .panel h2 { margin: 0 0 10px; font-size: 16px; color: var(--muted); font-weight: 700; letter-spacing: 0.3px; }
    .nav {
      display: grid; gap: 8px;
    }
    .nav button {
      width: 100%;
      text-align: left;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.05);
      color: var(--text);
      cursor: pointer;
      transition: transform 80ms ease, background 140ms ease, border-color 140ms ease;
    }
    .nav button:hover { background: rgba(255,255,255,0.08); }
    .nav button:active { transform: translateY(1px); }
    .nav button[aria-current="true"] {
      border-color: rgba(80,180,255,0.55);
      background: rgba(80,180,255,0.12);
    }
    .nav small { color: var(--muted); }

    .card { padding: 18px; }
    .card h2 { margin: 0 0 6px; font-size: 20px; }
    .card .subtitle { margin: 0 0 12px; color: var(--muted); }

    .dossier {
      border-radius: 16px;
      border: 1px dashed rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.22);
      padding: 12px;
      margin: 10px 0 14px;
    }
    pre {
      margin: 0;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.35);
      overflow: auto;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 14px;
    }

    label { display: block; margin: 10px 0 6px; color: var(--muted); font-size: 13px; }
    input, textarea {
      width: 100%;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.06);
      color: var(--text);
      font-size: 15px;
      outline: none;
    }
    input:focus, textarea:focus {
      border-color: rgba(80,180,255,0.55);
      box-shadow: 0 0 0 4px rgba(80,180,255,0.12);
    }
    textarea { min-height: 110px; resize: vertical; }

    .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .btn {
      appearance: none;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(255,255,255,0.08);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 700;
      transition: transform 80ms ease, background 140ms ease;
      user-select: none;
    }
    .btn:hover { background: rgba(255,255,255,0.12); }
    .btn:active { transform: translateY(1px); }
    .btn.primary {
      border-color: rgba(80,180,255,0.42);
      background: rgba(80,180,255,0.18);
    }
    .btn.primary:hover { background: rgba(80,180,255,0.24); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }

    .hint {
      border-left: 3px solid rgba(80,180,255,0.55);
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(80,180,255,0.08);
      color: var(--muted);
      margin-top: 10px;
      display: none;
    }

    .msg {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.06);
      display: none;
    }
    .msg.ok { background: var(--ok); border-color: rgba(60,230,170,0.32); display: block; }
    .msg.bad { background: var(--bad); border-color: rgba(255,90,120,0.32); display: block; }

    .footer {
      margin-top: 14px;
      font-size: 13px;
      color: rgba(233,236,241,0.65);
    }

    .kbd {
      display: inline-flex;
      padding: 2px 8px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(255,255,255,0.08);
      color: rgba(233,236,241,0.88);
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="titlebox">
        <h1>üï∂ –ò–≥—Ä–∞ ¬´–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∞–¥—Ä–µ—Å¬ª</h1>
        <p>7 –∫–ª–∞—Å—Å ‚Ä¢ –ê–¥—Ä–µ—Å–∞—Ü–∏—è –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ ‚Ä¢ –†–∞–∑–≥–∞–¥–∞–π –¥–æ—Å—å–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ –∞–¥—Ä–µ—Å–∞</p>
      </div>
      <div class="row">
        <div class="chip" id="chipStep">üìÅ –î–æ—Å—å–µ: <b id="stepLabel">–í–≤–µ–¥–µ–Ω–∏–µ</b></div>
        <div class="chip">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É¬ª</div>
      </div>
    </header>

    <div class="progress" aria-label="–ü—Ä–æ–≥—Ä–µ—Å—Å">
      <div class="bar" id="bar"></div>
    </div>

    <div class="grid">
      <aside class="panel">
        <h2>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h2>
        <div class="nav" id="nav"></div>

        <div class="footer">
          <div>–°–æ–≤–µ—Ç: –º–æ–∂–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–æ –ø–æ—Ä—è–¥–∫—É.</div>
          <div>–ù–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –º–µ–Ω—é —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.</div>
        </div>
      </aside>

      <main class="card" id="app" aria-live="polite"></main>
    </div>
  </div>

<script>
(() => {
  // -----------------------
  // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –æ—Ç–≤–µ—Ç—ã –Ω–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω.
  // –í–ê–ñ–ù–û: –≤ –ª—é–±–æ–º HTML/JS —É—á–µ–Ω–∏–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å –∫–æ–¥,
  // –µ—Å–ª–∏ –æ—Ç–∫—Ä–æ–µ—Ç –∏—Å—Ö–æ–¥–Ω–∏–∫. –î–ª—è "–∂–µ–ª–µ–∑–Ω–æ–π" –∑–∞—â–∏—Ç—ã –Ω—É–∂–µ–Ω —Å–µ—Ä–≤–µ—Ä.
  // –ù–æ –¥–ª—è —à–∫–æ–ª—å–Ω–æ–π –∏–≥—Ä—ã —ç—Ç–æ–≥–æ –æ–±—ã—á–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.
  // -----------------------

  const app = document.getElementById("app");
  const nav = document.getElementById("nav");
  const bar = document.getElementById("bar");
  const stepLabel = document.getElementById("stepLabel");

  const STORAGE_KEY = "secretAddressGame_v1";

  const state = loadState();

  const steps = [
    {
      id: "intro",
      name: "–í–≤–µ–¥–µ–Ω–∏–µ",
      icon: "üóù",
      progress: 0,
      render: () => `
        <h2>üóù –í–≤–µ–¥–µ–Ω–∏–µ</h2>
        <p class="subtitle">–¢—ã ‚Äî –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞–≥–µ–Ω—Ç. –£ —Ç–µ–±—è 5 –¥–æ—Å—å–µ. –í –∫–∞–∂–¥–æ–º —Å–ø—Ä—è—Ç–∞–Ω –∞–¥—Ä–µ—Å —Å–∞–π—Ç–∞.</p>

        <div class="dossier">
          <p><b>–ü—Ä–∞–≤–∏–ª–∞:</b></p>
          <ul>
            <li>–ß–∏—Ç–∞–π –∑–∞–¥–∞–Ω–∏–µ ‚Üí –≤–≤–æ–¥–∏ –æ—Ç–≤–µ—Ç ‚Üí –Ω–∞–∂–∏–º–∞–π <span class="kbd">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</span>.</li>
            <li>–ï—Å–ª–∏ —Å–ª–æ–∂–Ω–æ ‚Äî –∂–º–∏ <span class="kbd">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</span>.</li>
            <li>–ö–æ–≥–¥–∞ –¥–æ—Å—å–µ –∑–∞–∫—Ä—ã—Ç–æ ‚úÖ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏ –¥–∞–ª—å—à–µ.</li>
          </ul>
        </div>

        <div class="row">
          <button class="btn primary" data-go="d1">‚ñ∂ –ù–∞—á–∞—Ç—å</button>
          <button class="btn" id="resetAll">üîÅ –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
        </div>

        <div class="msg" id="msgIntro"></div>
      `,
      wire: () => {
        document.getElementById("resetAll").addEventListener("click", () => {
          if (!confirm("–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ?")) return;
          localStorage.removeItem(STORAGE_KEY);
          location.reload();
        });
      }
    },

    {
      id: "d1",
      name: "–î–æ—Å—å–µ ‚Ññ1",
      icon: "üìÅ",
      progress: 20,
      render: () => `
        <h2>üìÅ –î–æ—Å—å–µ ‚Ññ1 ‚Äî ¬´–ü–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –±—É–∫–≤—ã¬ª</h2>
        <p class="subtitle">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ –∏ –µ–≥–æ –∞–¥—Ä–µ—Å.</p>

        <div class="dossier">
          <pre>p i a w e i d i k</pre>
        </div>

        <p><b>–ó–∞–¥–∞–Ω–∏–µ:</b> –Ω–∞–ø–∏—à–∏ –∞–¥—Ä–µ—Å —Å–∞–π—Ç–∞ (–º–æ–∂–Ω–æ –±–µ–∑ https://).</p>

        <label>–¢–≤–æ–π –æ—Ç–≤–µ—Ç</label>
        <input id="in1" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: site.com" autocomplete="off"/>

        <div class="row" style="margin-top:12px;">
          <button class="btn primary" id="check1">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <button class="btn" id="hint1">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</button>
          <button class="btn primary" id="next1" data-go="d2" disabled>–î–∞–ª—å—à–µ ‚ûú</button>
        </div>

        <div class="hint" id="hintBox1">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: —ç—Ç–æ —Å–∞–º—ã–π –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–∞–π—Ç-—ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—è, –≥–¥–µ —á–∏—Ç–∞—é—Ç —Å—Ç–∞—Ç—å–∏.</div>
        <div class="msg" id="msg1"></div>
      `,
      wire: () => {
        const in1 = document.getElementById("in1");
        const msg = document.getElementById("msg1");
        const next = document.getElementById("next1");
        const hintBtn = document.getElementById("hint1");
        const hintBox = document.getElementById("hintBox1");

        hintBtn.addEventListener("click", () => hintBox.style.display = "block");

        document.getElementById("check1").addEventListener("click", () => {
          const v = normalize(in1.value);

          // –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –±—ã–ª–æ "wikipedia"
          // –∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –¥–æ–º–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å.
          const ok = v.includes("wikipedia") && (v.includes(".") || v.includes("://"));

          setMsg(msg, ok,
            ok ? "‚úÖ –ü—Ä–∏–Ω—è—Ç–æ! –î–æ—Å—å–µ ‚Ññ1 –∑–∞–∫—Ä—ã—Ç–æ." : "‚ùå –ù–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –∞–¥—Ä–µ—Å. –ü–æ–¥—É–º–∞–π –ø—Ä–æ —Å–∞–π—Ç-—ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—é."
          );

          if (ok) {
            state.done.d1 = true;
            saveState();
            next.disabled = false;
            refreshNav();
          }
        });

        if (state.done.d1) next.disabled = false;
      }
    },

    {
      id: "d2",
      name: "–î–æ—Å—å–µ ‚Ññ2",
      icon: "üìÅ",
      progress: 40,
      render: () => `
        <h2>üìÅ –î–æ—Å—å–µ ‚Ññ2 ‚Äî ¬´–†–∞–∑–±–∏—Ç—ã–π –∞–¥—Ä–µ—Å¬ª</h2>
        <p class="subtitle">–°–æ–±–µ—Ä–∏ –∞–¥—Ä–µ—Å, —É–±—Ä–∞–≤ –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã.</p>

        <div class="dossier">
          <pre>h t t p s : / / y o u t u b e . c o m</pre>
        </div>

        <p><b>–ó–∞–¥–∞–Ω–∏–µ:</b> –Ω–∞–ø–∏—à–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å.</p>

        <label>–¢–≤–æ–π –æ—Ç–≤–µ—Ç</label>
        <input id="in2" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: https://site.com" autocomplete="off"/>

        <div class="row" style="margin-top:12px;">
          <button class="btn primary" id="check2">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <button class="btn" id="hint2">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</button>
          <button class="btn primary" id="next2" data-go="d3" disabled>–î–∞–ª—å—à–µ ‚ûú</button>
        </div>

        <div class="hint" id="hintBox2">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: —ç—Ç–æ —Å–∞–π—Ç —Å –≤–∏–¥–µ–æ. –í –∞–¥—Ä–µ—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å <b>https://</b>.</div>
        <div class="msg" id="msg2"></div>
      `,
      wire: () => {
        const in2 = document.getElementById("in2");
        const msg = document.getElementById("msg2");
        const next = document.getElementById("next2");
        const hintBtn = document.getElementById("hint2");
        const hintBox = document.getElementById("hintBox2");

        hintBtn.addEventListener("click", () => hintBox.style.display = "block");

        document.getElementById("check2").addEventListener("click", () => {
          const v = normalizeUrl(in2.value);

          // –õ—ë–≥–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å https:// –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å youtube –∏ .com
          const ok = v.startsWith("https://") && v.includes("youtube") && (v.endsWith(".com") || v.includes(".com/"));

          setMsg(msg, ok,
            ok ? "‚úÖ –û—Ç–ª–∏—á–Ω–æ! –î–æ—Å—å–µ ‚Ññ2 –∑–∞–∫—Ä—ã—Ç–æ." : "‚ùå –ü–æ–∫–∞ –Ω–µ—Ç. –ü—Ä–æ–≤–µ—Ä—å: https:// + –Ω–∞–∑–≤–∞–Ω–∏–µ + .com"
          );

          if (ok) {
            state.done.d2 = true;
            saveState();
            next.disabled = false;
            refreshNav();
          }
        });

        if (state.done.d2) next.disabled = false;
      }
    },

    {
      id: "d3",
      name: "–î–æ—Å—å–µ ‚Ññ3",
      icon: "üìÅ",
      progress: 60,
      render: () => `
        <h2>üìÅ –î–æ—Å—å–µ ‚Ññ3 ‚Äî ¬´–õ–∏—à–Ω–∏–π —Å–∏–º–≤–æ–ª¬ª</h2>
        <p class="subtitle">–ù–∞–π–¥–∏ –ª–∏—à–Ω–∏–π —Å–∏–º–≤–æ–ª –∏ –∏—Å–ø—Ä–∞–≤—å –∞–¥—Ä–µ—Å.</p>

        <div class="dossier">
          <pre>https://school@com</pre>
        </div>

        <p><b>–ó–∞–¥–∞–Ω–∏–µ:</b> –Ω–∞–ø–∏—à–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å.</p>

        <label>–¢–≤–æ–π –æ—Ç–≤–µ—Ç</label>
        <input id="in3" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: https://site.com" autocomplete="off"/>

        <div class="row" style="margin-top:12px;">
          <button class="btn primary" id="check3">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <button class="btn" id="hint3">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</button>
          <button class="btn primary" id="next3" data-go="d4" disabled>–î–∞–ª—å—à–µ ‚ûú</button>
        </div>

        <div class="hint" id="hintBox3">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –≤ –∞–¥—Ä–µ—Å–∞—Ö —Å–∞–π—Ç–æ–≤ —Å–∏–º–≤–æ–ª <b>@</b> –æ–±—ã—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.</div>
        <div class="msg" id="msg3"></div>
      `,
      wire: () => {
        const in3 = document.getElementById("in3");
        const msg = document.getElementById("msg3");
        const next = document.getElementById("next3");
        const hintBtn = document.getElementById("hint3");
        const hintBox = document.getElementById("hintBox3");

        hintBtn.addEventListener("click", () => hintBox.style.display = "block");

        document.getElementById("check3").addEventListener("click", () => {
          const v = normalizeUrl(in3.value);

          // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Å—Ç–∞—è: https://school.com (–±–µ–∑ @)
          const ok = v.startsWith("https://") && v.includes("school") && v.includes(".com") && !v.includes("@");

          setMsg(msg, ok,
            ok ? "‚úÖ –í–µ—Ä–Ω–æ! –î–æ—Å—å–µ ‚Ññ3 –∑–∞–∫—Ä—ã—Ç–æ." : "‚ùå –ü—Ä–æ–≤–µ—Ä—å: –ª–∏—à–Ω–∏–π —Å–∏–º–≤–æ–ª –¥–æ–ª–∂–µ–Ω –∏—Å—á–µ–∑–Ω—É—Ç—å, –∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–æ—á–∫–∞ –ø–µ—Ä–µ–¥ com."
          );

          if (ok) {
            state.done.d3 = true;
            saveState();
            next.disabled = false;
            refreshNav();
          }
        });

        if (state.done.d3) next.disabled = false;
      }
    },

    {
      id: "d4",
      name: "–î–æ—Å—å–µ ‚Ññ4",
      icon: "üìÅ",
      progress: 80,
      render: () => `
        <h2>üìÅ –î–æ—Å—å–µ ‚Ññ4 ‚Äî ¬´–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–¥¬ª</h2>
        <p class="subtitle">–ü–æ –æ–ø–∏—Å–∞–Ω–∏—é —É–≥–∞–¥–∞–π —Å–∞–π—Ç –∏ –Ω–∞–ø–∏—à–∏ –µ–≥–æ –∞–¥—Ä–µ—Å.</p>

        <div class="dossier">
          <pre>[–≤–∏–¥–µ–æ] + [–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π] + [.com]</pre>
        </div>

        <p><b>–ó–∞–¥–∞–Ω–∏–µ:</b> –Ω–∞–ø–∏—à–∏ –∞–¥—Ä–µ—Å —Å–∞–π—Ç–∞ (–º–æ–∂–Ω–æ —Å https:// –∏–ª–∏ –±–µ–∑).</p>

        <label>–¢–≤–æ–π –æ—Ç–≤–µ—Ç</label>
        <input id="in4" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: site.com" autocomplete="off"/>

        <div class="row" style="margin-top:12px;">
          <button class="btn primary" id="check4">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <button class="btn" id="hint4">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É</button>
          <button class="btn primary" id="next4" data-go="d5" disabled>–î–∞–ª—å—à–µ ‚ûú</button>
        </div>

        <div class="hint" id="hintBox4">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å–∞–º—ã–π –∏–∑–≤–µ—Å—Ç–Ω—ã–π –≤–∏–¥–µ–æ—Å–∞–π—Ç –≤ –º–∏—Ä–µ.</div>
        <div class="msg" id="msg4"></div>
      `,
      wire: () => {
        const in4 = document.getElementById("in4");
        const msg = document.getElementById("msg4");
        const next = document.getElementById("next4");
        const hintBtn = document.getElementById("hint4");
        const hintBox = document.getElementById("hintBox4");

        hintBtn.addEventListener("click", () => hintBox.style.display = "block");

        document.getElementById("check4").addEventListener("click", () => {
          const v = normalizeUrl(in4.value);

          // –£–ø—Ä–æ—â—ë–Ω–Ω–æ: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —Å–æ–¥–µ—Ä–∂–∞–ª–æ—Å—å "youtube" –∏ .com
          const ok = v.includes("youtube") && v.includes(".com");

          setMsg(msg, ok,
            ok ? "‚úÖ –û—Ç–ª–∏—á–Ω–æ! –î–æ—Å—å–µ ‚Ññ4 –∑–∞–∫—Ä—ã—Ç–æ." : "‚ùå –ü–æ–∫–∞ –Ω–µ—Ç. –ü–æ–¥—É–º–∞–π –ø—Ä–æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π —Å–∞–π—Ç —Å –≤–∏–¥–µ–æ –∏ –¥–æ–º–µ–Ω .com."
          );

          if (ok) {
            state.done.d4 = true;
            saveState();
            next.disabled = false;
            refreshNav();
          }
        });

        if (state.done.d4) next.disabled = false;
      }
    },

    {
      id: "d5",
      name: "–î–æ—Å—å–µ ‚Ññ5",
      icon: "üèÅ",
      progress: 100,
      render: () => `
        <h2>üèÅ –î–æ—Å—å–µ ‚Ññ5 ‚Äî ¬´–¢—ã –∞–≥–µ–Ω—Ç¬ª</h2>
        <p class="subtitle">–§–∏–Ω–∞–ª—å–Ω–∞—è –º–∏—Å—Å–∏—è: –ø—Ä–∏–¥—É–º–∞–π —Å–≤–æ—ë —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∞–¥—Ä–µ—Å.</p>

        <div class="dossier">
          <p><b>–°–¥–µ–ª–∞–π —Ç–∞–∫:</b></p>
          <ol>
            <li>–ü—Ä–∏–¥—É–º–∞–π —Å–∞–π—Ç (–æ —á—ë–º –æ–Ω?).</li>
            <li>–ù–∞–ø–∏—à–∏ –∞–¥—Ä–µ—Å —ç—Ç–æ–≥–æ —Å–∞–π—Ç–∞.</li>
            <li>–ù–∞–ø–∏—à–∏ —Å–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —á—Ç–æ–±—ã –¥—Ä—É–≥–æ–π —Å–º–æ–≥ —É–≥–∞–¥–∞—Ç—å.</li>
          </ol>
        </div>

        <label>–¢–≤–æ–π —Ç–µ–∫—Å—Ç (–º–æ–∂–Ω–æ –≤ 2‚Äì4 —Å—Ç—Ä–æ–∫–∏)</label>
        <textarea id="finalText" placeholder="–ü—Ä–∏–º–µ—Ä: [–∏–≥—Ä—ã] + [–ø–æ–¥—Ä–æ—Å—Ç–∫–∏] + [.com]&#10;–ê–¥—Ä–µ—Å: https://..."></textarea>

        <div class="row" style="margin-top:12px;">
          <button class="btn primary" id="saveFinal">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          <button class="btn" id="copyFinal">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          <button class="btn" id="restart">üîÅ –°–Ω–∞—á–∞–ª–∞</button>
        </div>

        <div class="msg" id="msg5"></div>

        <div class="footer">
          –£—á–∏—Ç–µ–ª—é: —É—á–µ–Ω–∏–∫ –º–æ–∂–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç/–ø–æ—á—Ç—É.\n
        </div>
      `,
      wire: () => {
        const t = document.getElementById("finalText");
        const msg = document.getElementById("msg5");

        const saved = state.finalText || "";
        t.value = saved;

        document.getElementById("saveFinal").addEventListener("click", () => {
          state.finalText = t.value || "";
          saveState();
          setMsg(msg, true, "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.");
          refreshNav();
        });

        document.getElementById("copyFinal").addEventListener("click", async () => {
          try {
            await navigator.clipboard.writeText(t.value || "");
            setMsg(msg, true, "üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ! –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É—á–∏—Ç–µ–ª—é.");
          } catch {
            setMsg(msg, false, "–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –í—ã–¥–µ–ª–∏ —Ç–µ–∫—Å—Ç –∏ —Å–∫–æ–ø–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é.");
          }
        });

        document.getElementById("restart").addEventListener("click", () => {
          go("intro");
        });
      }
    }
  ];

  // ---------- UI helpers ----------
  function setMsg(el, ok, text) {
    el.className = "msg " + (ok ? "ok" : "bad");
    el.textContent = text;
  }

  function normalize(s) {
    return (s || "").trim().toLowerCase().replace(/\s+/g, "");
  }

  function normalizeUrl(s) {
    let v = (s || "").trim().toLowerCase().replace(/\s+/g, "");
    // –∏—Å–ø—Ä–∞–≤–∏–º —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å–ª—ç—à–µ–π
    v = v.replace(/^https\/\//, "https://").replace(/^http\/\//, "http://");
    return v;
  }

  function loadState() {
    try {
      return JSON.parse(localStorage.getItem(STORAGE_KEY)) || { done: {}, finalText: "" };
    } catch {
      return { done: {}, finalText: "" };
    }
  }

  function saveState() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  function refreshNav() {
    nav.innerHTML = steps.map(s => {
      const done = isDone(s.id);
      const current = (s.id === state.current);
      const label = `${s.icon} ${s.name}`;
      const right = done ? "‚úÖ" : "";
      return `
        <button type="button" data-go="${s.id}" aria-current="${current ? "true" : "false"}">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
            <div>${label}</div>
            <div>${right}</div>
          </div>
          <small>${navHint(s.id)}</small>
        </button>
      `;
    }).join("");

    nav.querySelectorAll("[data-go]").forEach(b => {
      b.addEventListener("click", () => go(b.getAttribute("data-go")));
    });
  }

  function navHint(id) {
    if (id === "intro") return "–ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã";
    if (id === "d1") return "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏—é";
    if (id === "d2") return "—Å–æ–±–µ—Ä–∏ –∞–¥—Ä–µ—Å –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤";
    if (id === "d3") return "—É–±–µ—Ä–∏ –ª–∏—à–Ω–∏–π —Å–∏–º–≤–æ–ª";
    if (id === "d4") return "—É–≥–∞–¥–∞–π –ø–æ –∫–æ–¥—É";
    if (id === "d5") return "—Å–æ–∑–¥–∞–π —Å–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ";
    return "";
  }

  function isDone(id) {
    if (id === "intro") return true;
    if (id === "d5") return Boolean(state.finalText && state.finalText.trim().length > 0);
    return Boolean(state.done[id]);
  }

  function go(id) {
    const step = steps.find(s => s.id === id) || steps[0];
    state.current = step.id;
    saveState();

    stepLabel.textContent = step.name;
    bar.style.width = step.progress + "%";
    app.innerHTML = step.render();

    // wire buttons for this step
    app.querySelectorAll("[data-go]").forEach(b => {
      b.addEventListener("click", () => go(b.getAttribute("data-go")));
    });

    if (step.wire) step.wire();
    refreshNav();
  }

  // start
  go(state.current || "intro");
})();
</script>
</body>
</html>
